# DXF Split - AutoCAD DWG 분할 도구

## 📋 개요

DXF Split은 AutoCAD/CADian에서 닫힌 폴리라인(사각형)을 기준으로 도면을 여러 개의 DWG 파일로 자동 분할하는 도구입니다.

## ✨ 주요 기능

- 📦 닫힌 폴리라인 내부의 모든 객체를 별도 파일로 저장
- 🔄 **90도 자동 회전** 저장 (폴리라인 중심점 기준)
- 📝 폴리라인 안의 텍스트를 읽어 자동으로 파일명 생성
- 🔤 **한글 파일명 완벽 지원** (순수 AutoLISP Unicode 디코더 탑재)
- 🏢 **블록 속성 텍스트 완벽 지원** (ATTDEF/ATTRIB 자동 인식)
- 🔧 CADian 및 구버전 AutoCAD 호환 (VL- 함수 미사용)

## 🚀 사용 방법

### 1. 설치

1. `dxfsplit_ver03.lsp` 파일을 다운로드합니다
2. AutoCAD/CADian에서 다음 방법 중 하나로 로드합니다:
   - 파일을 도면 창에 드래그 앤 드롭
   - 명령창에 `APPLOAD` 입력 후 파일 선택

### 2. 실행

1. 명령창에 다음 중 하나를 입력합니다:
   ```
   DDDD
   ```
   또는
   ```
   DXFRECT
   ```

2. 화면에 "Select closed polylines..." 메시지가 나타나면 분할하려는 닫힌 폴리라인들을 선택합니다

3. Enter 키를 눌러 선택을 완료합니다

### 3. 결과 확인

- 현재 도면 폴더 안에 도면명과 동일한 하위 폴더가 생성됩니다
- 각 폴리라인마다 별도의 DWG 파일이 생성됩니다
- **모든 객체가 폴리라인 중심점 기준으로 90도 회전되어 저장됩니다**
- 파일명은 폴리라인 안의 텍스트 내용으로 자동 지정됩니다

## 📂 출력 파일 구조

```
현재도면.dwg
└── 현재도면\
    ├── 텍스트내용1.dwg
    ├── 텍스트내용2.dwg
    └── 텍스트내용3.dwg
```

## 💡 사용 예시

### 예시 1: 도면 분할
1. 도면에 여러 개의 닫힌 사각형 폴리라인이 있습니다
2. 각 사각형 안에 "A동", "B동", "C동" 같은 텍스트가 있습니다
3. `DDDD` 명령어 실행 후 모든 사각형을 선택합니다
4. 결과: "A동.dwg", "B동.dwg", "C동.dwg" 파일이 생성됩니다

### 예시 2: 텍스트가 없는 경우
- 폴리라인 안에 텍스트가 없으면 "polyline.dwg"로 저장됩니다

## ⚠️ 주의사항

- ✅ **닫힌 폴리라인**만 처리됩니다
- ✅ 최소 **3개 이상의 꼭짓점**이 있어야 합니다
- ✅ 폴리라인 **안쪽에 있는 모든 객체**가 함께 저장됩니다
- ✅ 같은 이름의 파일이 있으면 **덮어쓰기** 됩니다

## 🔧 호환성

- ✅ AutoCAD 2000 이상
- ✅ CADian
- ✅ 순수 AutoLISP 기반으로 광범위한 호환성

## 📌 팁

1. **파일명 관리**: 폴리라인 안에 명확한 텍스트를 넣어두면 의미있는 파일명이 자동 생성됩니다
2. **한글 사용**: 한글 텍스트도 파일명으로 사용할 수 있습니다
3. **여러 텍스트**: 폴리라인 안에 여러 텍스트가 있으면 모두 합쳐서 파일명이 됩니다 (언더바로 구분)
4. **블록 내 텍스트**: 블록 안의 텍스트도 자동으로 인식됩니다

## 🐛 문제 해결

### 파일이 생성되지 않아요
- 폴리라인이 닫혀있는지 확인하세요
- 폴리라인에 최소 3개 이상의 꼭짓점이 있는지 확인하세요

### 파일명이 이상해요
- 특수문자는 자동으로 언더바(_)로 변환됩니다
- Windows에서 허용하지 않는 문자는 자동으로 처리됩니다

### 한글 파일명이 깨지거나 ''으로 표시되는 경우

**진단 방법:**
1. 도면 폴더의 `console.log` 파일을 확인하세요
2. 로그에서 "DXF(1) 원본" 부분을 찾아 어떤 형태로 저장되어 있는지 확인

**해결 방법:**
- **Unicode escape 형태** (`\U+XXXX`): 자동으로 한글로 변환됩니다
- **직접 UTF-8 형태**: 그대로 사용됩니다
- **알 수 없는 형태**: console.log를 개발자에게 제공하여 지원 요청

**시스템 설정:**
- Windows 시스템 언어가 한국어로 설정되어 있는지 확인
- PowerShell에서 UTF-8 지원이 활성화되어 있는지 확인

**상세 가이드:**
- `한글처리_테스트가이드.md` 파일을 참고하세요

## 📄 라이선스

자유롭게 사용하실 수 있습니다.

## 📞 지원

문제가 발생하거나 건의사항이 있으시면 이슈를 등록해주세요.

---

## 📝 업데이트 내역

### Version 1.2 (2024-10-17)
- 🔄 **90도 자동 회전 기능 추가**
- 폴리라인 중심점 기준으로 모든 객체 회전
- 저장 전 자동 회전으로 도면 방향 표준화

### Version 1.1 (2024-10-17)
- ✨ 순수 AutoLISP 기반 Unicode 디코더 추가
- 🔤 한글 처리 대폭 개선 (블록 내 한글 완벽 지원)
- 📊 상세한 디버그 로깅 시스템 추가
- 🐛 블록 정의 및 속성 텍스트 추출 안정성 향상
- 📖 한글 처리 테스트 가이드 추가

### Version 1.0 (2024)
- 🎉 초기 릴리스
- 기본 DWG 분할 기능

---

**Current Version**: 1.2
**Last Updated**: 2024-10-17

